const asyncHandler = require('express-async-handler');\n\nconst authorize = (...allowedRoles) => {\n  return asyncHandler(async (req, res, next) => {\n    if (!req.user) {\n      res.status(401);\n      throw new Error('Not authenticated');\n    }\n    if (!allowedRoles.includes(req.user.role)) {\n      res.status(403);\n      throw new Error('Forbidden: insufficient role');\n    }\n    next();\n  });\n};\n\nmodule.exports = { authorize };